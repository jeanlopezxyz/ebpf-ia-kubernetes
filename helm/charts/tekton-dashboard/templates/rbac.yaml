apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: tekton-dashboard-info
  namespace: {{ .Release.Namespace }}
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
rules:
  - apiGroups: [""]
    resourceNames: ["dashboard-info"]
    resources: ["configmaps"]
    verbs: ["get"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: tekton-dashboard-info
  namespace: {{ .Release.Namespace }}
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tekton-dashboard-info
subjects:
  - apiGroup: rbac.authorization.k8s.io
    kind: Group
    name: system:authenticated
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: tekton-dashboard-backend-edit
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
rules:
  - apiGroups: [""]
    resources: ["serviceaccounts"]
    verbs: ["get","list","watch"]
  - apiGroups: ["dashboard.tekton.dev"]
    resources: ["extensions"]
    verbs: ["create","update","delete","patch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: tekton-dashboard-backend-view
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
rules:
  - apiGroups: ["apiextensions.k8s.io"]
    resources: ["customresourcedefinitions"]
    verbs: ["get","list"]
  - apiGroups: ["security.openshift.io"]
    resources: ["securitycontextconstraints"]
    verbs: ["use"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: tekton-dashboard-tenant-view
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
rules:
  - apiGroups: ["dashboard.tekton.dev"]
    resources: ["extensions"]
    verbs: ["get","list","watch"]
  - apiGroups: [""]
    resources: ["events","namespaces","pods","pods/log"]
    verbs: ["get","list","watch"]
  - apiGroups: ["tekton.dev"]
    resources: ["clustertasks","conditions","pipelines","pipelineruns","pipelineresources","runs","tasks","taskruns","stepactions","customruns","verificationpolicies"]
    verbs: ["get","list","watch"]
  - apiGroups: ["triggers.tekton.dev"]
    resources: ["clustertriggerbindings","eventlisteners","interceptors","triggers","triggerbindings","triggertemplates"]
    verbs: ["get","list","watch"]
  - apiGroups: ["resolution.tekton.dev"]
    resources: ["resolutionrequests"]
    verbs: ["get","list","watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: tekton-dashboard-backend-view
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-dashboard-backend-view
subjects:
  - kind: ServiceAccount
    name: {{ include "tekton-dashboard.serviceAccountName" . }}
    namespace: {{ .Release.Namespace }}
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: tekton-dashboard-tenant-view
  labels:
{{ include "tekton-dashboard.labels" . | indent 4 }}
    rbac.dashboard.tekton.dev/subject: tekton-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: tekton-dashboard-tenant-view
subjects:
  - kind: ServiceAccount
    name: {{ include "tekton-dashboard.serviceAccountName" . }}
    namespace: {{ .Release.Namespace }}
